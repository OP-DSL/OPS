//
// auto-generated by ops.py
//

#define OPS_GPU

int xdim0_tvd_kernel;
int xdim1_tvd_kernel;

// user function
#pragma acc routine
inline void tvd_kernel(const ptrm_double tht, ptrm_double ep2) {
  double maxim;
  for (int m = 0; m < 3; m++) {
    if (OPS_ACC(tht, m, 0) > OPS_ACC(tht, m, 1))
      maxim = OPS_ACC(tht, m, 0);
    else
      maxim = OPS_ACC(tht, m, 1);
    OPS_ACC(ep2, m, 0) = akap2 * maxim;
  }
}

void tvd_kernel_c_wrapper(double *p_a0, double *p_a1, int x_size) {
#ifdef OPS_GPU
#pragma acc parallel deviceptr(p_a0, p_a1)
#pragma acc loop
#endif
  for (int n_x = 0; n_x < x_size; n_x++) {
#ifdef OPS_SOA
    const ptrm_double ptr0 = {p_a0 + n_x * 1 * 3, xdim0_tvd_kernel};
#else
    const ptrm_double ptr0 = {p_a0 + n_x * 1 * 3, 3};
#endif
#ifdef OPS_SOA
    ptrm_double ptr1 = {p_a1 + n_x * 1 * 3, xdim1_tvd_kernel};
#else
    ptrm_double ptr1 = {p_a1 + n_x * 1 * 3, 3};
#endif
    tvd_kernel(ptr0, ptr1);
  }
}
