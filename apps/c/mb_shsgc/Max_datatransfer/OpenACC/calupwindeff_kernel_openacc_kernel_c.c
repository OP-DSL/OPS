//
// auto-generated by ops.py
//
#include "./OpenACC/shsgc_common.h"

#define OPS_GPU

int xdim0_calupwindeff_kernel;
int xdim1_calupwindeff_kernel;
int xdim2_calupwindeff_kernel;
int xdim3_calupwindeff_kernel;
int xdim4_calupwindeff_kernel;
int xdim5_calupwindeff_kernel;
int xdim6_calupwindeff_kernel;

#undef OPS_ACC_MD0
#undef OPS_ACC_MD1
#undef OPS_ACC_MD2
#undef OPS_ACC_MD3
#undef OPS_ACC_MD4
#undef OPS_ACC_MD5
#undef OPS_ACC_MD6

#define OPS_ACC_MD0(d, x) ((x)*3 + (d))
#define OPS_ACC_MD1(d, x) ((x)*3 + (d))
#define OPS_ACC_MD2(d, x) ((x)*3 + (d))
#define OPS_ACC_MD3(d, x) ((x)*3 + (d))
#define OPS_ACC_MD4(d, x) ((x)*3 + (d))
#define OPS_ACC_MD5(d, x) ((x)*9 + (d))
#define OPS_ACC_MD6(d, x) ((x)*3 + (d))
// user function
inline void calupwindeff_kernel(const double *cmp, const double *gt,
                                const double *cf, const double *al,
                                const double *ep2, const double *r,
                                double *eff) {
  double e1 = (cmp[OPS_ACC_MD0(0, 0)] *
                   (gt[OPS_ACC_MD1(0, 0)] + gt[OPS_ACC_MD1(0, 1)]) -
               cf[OPS_ACC_MD2(0, 0)] * al[OPS_ACC_MD3(0, 0)]) *
              ep2[OPS_ACC_MD4(0, 0)];
  double e2 = (cmp[OPS_ACC_MD0(1, 0)] *
                   (gt[OPS_ACC_MD1(1, 0)] + gt[OPS_ACC_MD1(1, 1)]) -
               cf[OPS_ACC_MD2(1, 0)] * al[OPS_ACC_MD3(1, 0)]) *
              ep2[OPS_ACC_MD4(1, 0)];
  double e3 = (cmp[OPS_ACC_MD0(2, 0)] *
                   (gt[OPS_ACC_MD1(2, 0)] + gt[OPS_ACC_MD1(2, 1)]) -
               cf[OPS_ACC_MD2(2, 0)] * al[OPS_ACC_MD3(2, 0)]) *
              ep2[OPS_ACC_MD4(2, 0)];

  eff[OPS_ACC_MD6(0, 0)] = e1 * r[OPS_ACC_MD5(0, 0)] +
                           e2 * r[OPS_ACC_MD5(1, 0)] +
                           e3 * r[OPS_ACC_MD5(2, 0)];
  eff[OPS_ACC_MD6(1, 0)] = e1 * r[OPS_ACC_MD5(3, 0)] +
                           e2 * r[OPS_ACC_MD5(4, 0)] +
                           e3 * r[OPS_ACC_MD5(5, 0)];
  eff[OPS_ACC_MD6(2, 0)] = e1 * r[OPS_ACC_MD5(6, 0)] +
                           e2 * r[OPS_ACC_MD5(7, 0)] +
                           e3 * r[OPS_ACC_MD5(8, 0)];
}

#undef OPS_ACC_MD0
#undef OPS_ACC_MD1
#undef OPS_ACC_MD2
#undef OPS_ACC_MD3
#undef OPS_ACC_MD4
#undef OPS_ACC_MD5
#undef OPS_ACC_MD6

void calupwindeff_kernel_c_wrapper(double *p_a0, double *p_a1, double *p_a2,
                                   double *p_a3, double *p_a4, double *p_a5,
                                   double *p_a6, int x_size) {
#ifdef OPS_GPU
#pragma acc parallel deviceptr(p_a0, p_a1, p_a2, p_a3, p_a4, p_a5, p_a6)
#pragma acc loop
#endif
  for (int n_x = 0; n_x < x_size; n_x++) {
    calupwindeff_kernel(p_a0 + n_x * 1 * 3, p_a1 + n_x * 1 * 3,
                        p_a2 + n_x * 1 * 3, p_a3 + n_x * 1 * 3,
                        p_a4 + n_x * 1 * 3, p_a5 + n_x * 1 * 9,
                        p_a6 + n_x * 1 * 3);
  }
}
