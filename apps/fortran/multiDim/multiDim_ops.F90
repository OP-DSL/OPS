!
! auto-generated by ops_fortran.py
!


















program MULTIDIM
  use OPS_Fortran_Declarations
  use OPS_Fortran_RT_Support
  use MULTIDIM_KERNEL_MODULE
  use MULTIDIM_COPY_KERNEL_MODULE
  use MULTIDIM_PRINT_KERNEL_MODULE
  use MULTIDIM_REDUCE_KERNEL_MODULE
  use OPS_CONSTANTS






  use, intrinsic :: ISO_C_BINDING

  implicit none

  intrinsic :: sqrt, real

  integer x_cells /4/
  integer y_cells /4/

  type(ops_block)   :: grid2D

  type(ops_dat)     :: dat0, dat1

  integer s2D_00_arry(2) /0,0/
  type(ops_stencil) :: S2D_00

  type(ops_reduction) :: reduct_dat1

  integer d_p(2) /1,1/
  integer d_m(2) /-1,-1/

  integer size(2) /4,4/

  integer base1(2) /1,1/
  integer base2(2) /1,1/

  real(8) temp[allocatable](:)


  real(kind=c_double) :: startTime = 0
  real(kind=c_double) :: endTime = 0




  integer iter_range(4) /1,4,1,4/



  call ops_init(2)


  call ops_decl_block(2, grid2D, "grid2D")

  call ops_decl_stencil( 2, 1, s2D_00_arry, S2D_00, "00");


  call ops_decl_dat(grid2D, 2, size, base1, d_m, d_p, temp,  dat0, "double", "dat0");
  call ops_decl_dat(grid2D, 2, size, base2, d_m, d_p, temp,  dat1, "double", "dat1");

  const1 = 5.44_8
  call ops_decl_reduction_handle(8, reduct_dat1, "double", "reduct_dat1");

  call ops_partition("2D_BLOCK_DECOMPSE")
  call ops_diagnostic_output()

  call ops_timers ( startTime )

  call multidim_kernel_host("multidim_kernel", grid2D, 2, iter_range, &
                    & ops_arg_dat(dat0, 2, S2D_00, "real(8)", OPS_WRITE), &
                    & ops_arg_idx());

  call multidim_copy_kernel_host("multidim_copy_kernel", grid2D, 2, iter_range, &
                    & ops_arg_dat(dat0, 2, S2D_00, "real(8)", OPS_READ), &
                    & ops_arg_dat(dat1, 2, S2D_00, "real(8)", OPS_WRITE));

  call multidim_print_kernel_host("multidim_print_kernel", grid2D, 2, iter_range, &
                    & ops_arg_dat(dat0, 2, S2D_00, "real(8)", OPS_READ));

  call multidim_reduce_kernel_host("multidim_reduce_kernel", grid2D, 2, iter_range, &
                    & ops_arg_dat(dat1, 2, S2D_00, "real(8)", OPS_READ), &
                    & ops_arg_reduce(reduct_dat1, 1, "real(8)", OPS_INC));

  call ops_timers ( endTime )
  call ops_print_dat_to_txtfile(dat1, "multidim.dat");
  call ops_print_dat_to_txtfile(dat0, "multidim.dat");

  if (ops_is_root() .eq. 1) then
    write (*,*) 'Max total runtime =', endTime - startTime,'seconds'
  end if

  call ops_exit( )

end program MULTIDIM